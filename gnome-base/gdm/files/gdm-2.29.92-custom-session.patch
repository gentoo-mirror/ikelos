---
 fix custom sessions (see bug #216984, work done by Gilles, I'm just committing)

diff -ru gdm-2.29.92.orig/work/gdm-2.29.92/data/Xsession.in gdm-2.29.92/work/gdm-2.29.92/data/Xsession.in
--- gdm-2.29.92.orig/work/gdm-2.29.92/data/Xsession.in	2010-03-30 02:15:18.000000000 +0200
+++ gdm-2.29.92/work/gdm-2.29.92/data/Xsession.in	2010-03-30 02:17:37.000000000 +0200
@@ -177,15 +177,6 @@
   fi
 fi
 
-# run all system xinitrc shell scripts.
-if [ -d /etc/X11/xinit/xinitrc.d ]; then
-    for i in /etc/X11/xinit/xinitrc.d/* ; do
-        if [ -x "$i" -a ! -d "$i" ]; then
-	    . "$i"
-        fi
-    done
-fi
-
 if [ "x$command" = "xcustom" ] ; then
   if [ -x "$HOME/.xsession" ]; then
     command="$HOME/.xsession"
@@ -213,6 +204,15 @@
   fi
 fi
 
+# run all system xinitrc shell scripts.
+if [ -d /etc/X11/xinit/xinitrc.d ]; then
+    for i in /etc/X11/xinit/xinitrc.d/* ; do
+        if [ -x "$i" ]; then
+	    . "$i"
+        fi
+    done
+fi
+
 # add ssh-agent if found
 sshagent="`gdmwhich ssh-agent`"
 if [ -n "$sshagent" ] && [ -x "$sshagent" ] && [ -z "$SSH_AUTH_SOCK" ]; then
