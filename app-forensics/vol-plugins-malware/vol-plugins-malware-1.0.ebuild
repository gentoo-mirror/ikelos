# Copyright 1999-2009 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2
# $Header: $

inherit python

EAPI="2"

DESCRIPTION="Volatility plugin for examining malware in memory files"
HOMEPAGE="http://mhl-malware-scripts.googlecode.com/"
SRC_URI="http://mhl-malware-scripts.googlecode.com/files/malfind2.py
		 http://mhl-malware-scripts.googlecode.com/files/idt.py
		 http://mhl-malware-scripts.googlecode.com/files/kernel_hooks.py
		 http://mhl-malware-scripts.googlecode.com/files/orphan_threads.py
		 http://mhl-malware-scripts.googlecode.com/files/usermode_hooks2.py"
#		 Requires Andreas Schuster's enhancements to volatility
#		 http://mhl-malware-scripts.googlecode.com/files/driverirp.py

LICENSE="GPL-2"
SLOT="0"
KEYWORDS="~x86 ~amd64"
IUSE=""

DEPEND="app-forensics/volatility"
RDEPEND="${DEPEND}
		 app-forensics/vol-plugins-driverscan
		 dev-python/pefile
		 dev-python/pydasm"

src_unpack() {
	mkdir "${S}"
	for i in ${A};
	do
		echo "Copying ${i} from ${DISTDIR} to ${S}"
		cp -L "${DISTDIR}/${i}" "${S}"
	done
}

src_install() {
	local plugindir="$(python_get_sitedir)/memory_plugins"
	insinto ${plugindir}
	dodir ${plugindir}
	doins "${S}"/*
}
